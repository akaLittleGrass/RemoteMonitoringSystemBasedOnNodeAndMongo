{"remainingRequest":"/Users/weihaoyang/f2e/remoteMonitoringSystemBasedOnNode/remoteMonitoringFrontEnd/node_modules/babel-loader/lib/index.js!/Users/weihaoyang/f2e/remoteMonitoringSystemBasedOnNode/remoteMonitoringFrontEnd/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/weihaoyang/f2e/remoteMonitoringSystemBasedOnNode/remoteMonitoringFrontEnd/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/weihaoyang/f2e/remoteMonitoringSystemBasedOnNode/remoteMonitoringFrontEnd/src/views/operation.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/weihaoyang/f2e/remoteMonitoringSystemBasedOnNode/remoteMonitoringFrontEnd/src/views/operation.vue","mtime":1558184107000},{"path":"/Users/weihaoyang/f2e/remoteMonitoringSystemBasedOnNode/remoteMonitoringFrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weihaoyang/f2e/remoteMonitoringSystemBasedOnNode/remoteMonitoringFrontEnd/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/weihaoyang/f2e/remoteMonitoringSystemBasedOnNode/remoteMonitoringFrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weihaoyang/f2e/remoteMonitoringSystemBasedOnNode/remoteMonitoringFrontEnd/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _getIterator from \"/Users/weihaoyang/f2e/remoteMonitoringSystemBasedOnNode/remoteMonitoringFrontEnd/node_modules/@babel/runtime-corejs2/core-js/get-iterator\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es6.object.assign\";\nimport \"core-js/modules/es7.promise.finally\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from 'axios';\nimport request from '../utils/request';\n\nvar echarts = require('echarts');\n\nexport default {\n  name: 'operation',\n  data: function data() {\n    return {\n      user: '',\n      userType: '',\n      showMobileMenu: false,\n      manageTagShow: false,\n      manageOpType: '修改密码',\n      inputUserName: '',\n      inputPassWord: '',\n      inputUserType: '',\n      IO1Status: false,\n      IO2Status: false,\n      motorIsOn: false,\n      isSlow: false,\n      isForward: false,\n      temperature: '',\n      humidity: '',\n      timeStamp: ''\n    };\n  },\n  mounted: function mounted() {\n    var token = localStorage.getItem('token');\n    var that = this;\n\n    if (token) {\n      axios.defaults.headers.common['token'] = token;\n      request('/users/verify', 'GET').then(function (response) {\n        if (response.status === 200) {\n          that.user = response.data.userName;\n          that.userType = response.data.type;\n        }\n      });\n    }\n\n    ;\n    request('/device/find', 'GET').then(function (response) {\n      if (response.status === 200) {\n        var deviceList = response.data;\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = _getIterator(deviceList), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var value = _step.value;\n\n            switch (value.id) {\n              case 'device1':\n                that.IO1Status = value.status;\n                break;\n\n              case 'device2':\n                that.IO2Status = value.status;\n                break;\n\n              case 'device3':\n                that.motorIsOn = value.status;\n                that.isSlow = value.isSlow;\n                that.isForward = value.isForward;\n                break;\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator.return != null) {\n              _iterator.return();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n\n        that.drawLine();\n      }\n    });\n  },\n  methods: {\n    logout: function logout() {\n      localStorage.removeItem('token');\n      this.goToLogin();\n    },\n    goToLogin: function goToLogin() {\n      this.$router.push({\n        path: '/login'\n      });\n    },\n    toggleMobileMenu: function toggleMobileMenu() {\n      this.showMobileMenu = !this.showMobileMenu;\n    },\n    showManageTag: function showManageTag() {\n      this.manageTagShow = !this.manageTagShow;\n    },\n    setOpType: function setOpType(type) {\n      this.manageOpType = type;\n    },\n    editUserInfo: function editUserInfo() {\n      var path;\n      var that = this;\n      var data = {\n        userName: this.inputUserName,\n        passWord: this.inputPassWord,\n        type: this.inputUserType\n      };\n\n      switch (this.manageOpType) {\n        case '修改密码':\n          path = '/users/update';\n          delete data.type;\n          break;\n\n        case '添加用户':\n          path = '/users/insert';\n          break;\n\n        case '删除用户':\n          path = '/users/delete';\n          delete data.passWord;\n          delete data.type;\n          break;\n      }\n\n      request(path, 'POST', data).then(function (response) {\n        if (response.data.result === 'succeed') {\n          that.manageTagShow = false;\n          that.showMobileMenu = false;\n          that.$message({\n            message: '操作成功',\n            type: 'success',\n            customClass: 'messageBox'\n          });\n        }\n      });\n    },\n    setDeviceStatus: function setDeviceStatus(deviceId) {\n      var deviceStatus;\n      var setSpeed;\n      var setDirection;\n\n      switch (deviceId) {\n        case 'device1':\n          deviceStatus = !this.IO1Status;\n          break;\n\n        case 'device2':\n          deviceStatus = !this.IO2Status;\n          break;\n\n        case 'device3':\n          deviceStatus = !this.motorIsOn;\n          break;\n\n        case 'speed':\n          setSpeed = {\n            id: 'device3',\n            isSlow: !this.isSlow\n          };\n          break;\n\n        case 'direction':\n          setDirection = {\n            id: 'device3',\n            isForward: !this.isForward\n          };\n      }\n\n      var path = '/device/setDevice';\n      var that = this;\n      var data = {\n        id: deviceId,\n        status: deviceStatus\n      };\n      request(path, 'POST', setSpeed || setDirection || data).then(function (response) {\n        if (response.data === 'succeed') {\n          switch (deviceId) {\n            case 'device1':\n              that.IO1Status = !that.IO1Status;\n              break;\n\n            case 'device2':\n              that.IO2Status = !that.IO2Status;\n              break;\n\n            case 'device3':\n              that.motorIsOn = !that.motorIsOn;\n              break;\n\n            case 'speed':\n              that.isSlow = !that.isSlow;\n              break;\n\n            case 'direction':\n              that.isForward = !that.isForward;\n          }\n        } else {\n          that.$message({\n            message: '操作失败',\n            type: 'warning',\n            customClass: 'messageBox',\n            duration: 1500\n          });\n        }\n      });\n    },\n    drawLine: function drawLine() {\n      var temData = [];\n      var humData = [];\n      var chartOption = {\n        title: {\n          text: '温湿度(%)'\n        },\n        legend: {\n          data: ['温度', '湿度']\n        },\n        animation: false,\n        tooltip: {\n          trigger: 'axis'\n        },\n        xAxis: {\n          type: 'category',\n          boundaryGap: false,\n          data: [1, 2, 3, 4, 5, 6]\n        },\n        yAxis: {\n          type: 'value'\n        },\n        series: [{\n          name: '温度',\n          type: 'line',\n          data: temData\n        }, {\n          name: '湿度',\n          type: 'line',\n          data: humData\n        }]\n      };\n      var chartContainner = this.$refs.chartContainner;\n      var that = this;\n\n      if (chartContainner) {\n        var chart = echarts.init(chartContainner);\n        chart.setOption(chartOption);\n        setInterval(function () {\n          request('/device/read', 'GET').then(function (response) {\n            if (response.data.temperature && response.data.humidity) {\n              that.temperature = response.data.temperature;\n              that.humidity = response.data.humidity;\n              that.timeStamp = new Date();\n              if (temData.length === 6) temData.shift();\n              temData.push(response.data.temperature);\n              if (humData.length === 6) humData.shift();\n              humData.push(response.data.humidity);\n              chart.setOption({\n                series: [{\n                  seriesIndex: 0,\n                  data: temData\n                }, {\n                  seriesIndex: 1,\n                  data: humData\n                }]\n              });\n            }\n          });\n        }, 2000);\n      }\n    }\n  }\n};",{"version":3,"sources":["operation.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"root\">\n        <header class=\"top-bar\">\n            <section>\n                <h1>Remote Monitoring System</h1>\n            </section>\n            <div class=\"state\">\n                <ul v-if=\"user\" class=\"pc-menu\">\n                    <li>{{this.user}}</li>\n                    <li @click=\"showManageTag\" class=\"user-type\" v-if=\"userType === 'master'\">[管理员权限]</li>\n                    <li class=\"log-btn\" @click=\"logout\">\n                        <img src=\"../../dist/img/16pxlogout.svg\" alt=\"logout\">\n                        <span>退出登陆</span>\n                    </li>\n                </ul>\n                <ul v-else class=\"pc-menu\">\n                    <li class=\"log-btn\" @click=\"goToLogin\">点击登录</li>\n                </ul>\n                <div @click=\"toggleMobileMenu\" class=\"mobile-menu-btn mobile-show\">\n                    <img src=\"../../dist/img/menu.svg\" alt=\"mobile-menu\">\n                </div>\n            </div>\n        </header>\n        <div class=\"mobile-nav-bar mobile-show\" :class=\"{mobileMenuShow: !showMobileMenu}\">\n            <ul v-if=\"user\">\n                <li>{{this.user}}<span @click=\"showManageTag\" class=\"user-type\" v-if=\"userType === 'master'\">[管理员权限]</span></li>\n                <li @click=\"logout\" class=\"log-btn\"> <img src=\"../../dist/img/16pxlogout.svg\" alt=\"logout\"><span style=\"font-size:17px;\">退出登陆</span></li>\n            </ul>\n            <ul v-else>\n                <li @click=\"goToLogin\">点击登陆</li>\n            </ul>\n        </div>\n        <div class=\"operation-area\" v-if=\"user\">\n            <div class=\"device-btn\">\n                <span class=\"device-detail\">「一号设备」 当前状态：{{IO1Status?'开启':'关闭'}} </span><el-button type=\"info\" @click=\"setDeviceStatus('device1')\">{{IO1Status?'关闭':'开启'}}</el-button>\n            </div>\n            <div class=\"device-btn\">\n                <span class=\"device-detail\">「二号设备」 当前状态：{{IO2Status?'开启':'关闭'}} </span><el-button type=\"info\" @click=\"setDeviceStatus('device2')\">{{IO2Status?'关闭':'开启'}}</el-button>\n            </div>\n            <div class=\"device-btn\">\n                <span class=\"device-detail\">「步进电机」 当前状态：{{motorIsOn?'开启':'关闭'}} </span><el-button type=\"info\" @click=\"setDeviceStatus('device3')\">{{motorIsOn?'关闭':'开启'}}</el-button>\n            </div>\n            <div class=\"device-btn\">\n                <span class=\"device-detail\">「电机转速」 当前状态：{{motorIsOn?isSlow?'慢速':'快速':'——'}} </span><el-button type=\"info\" :disabled=\"!motorIsOn\" @click=\"setDeviceStatus('speed')\">切换</el-button>\n            </div>\n            <div class=\"device-btn\">\n                <span class=\"device-detail\">「电机转向」 当前状态：{{motorIsOn?isForward?'正向':'反向':'——'}} </span><el-button type=\"info\" :disabled=\"!motorIsOn\" @click=\"setDeviceStatus('direction')\">切换</el-button>\n            </div>\n        </div>\n        <div id=\"number-bar\" v-if=\"user\">\n            温度值：{{temperature}}°C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;湿度值：{{humidity}}%<br/>\n            <span class=\"time-stamp\">{{timeStamp}}</span>\n        </div>\n        <div id=\"chart\" ref=\"chartContainner\" class=\"operation-area\" v-if=\"user\">\n           \n        </div>\n        <div v-if=\"!user\" class=\"notice\">\n            请登陆\n        </div>\n        <el-dialog\n            title=\"管理员权限\"\n            :visible.sync=\"manageTagShow\"\n            :center=\"true\"\n            :fullscreen=\"true\"\n            >\n            <el-dropdown @command=\"setOpType\">\n                <span class=\"el-dropdown-link\">\n                    {{manageOpType}}<i class=\"el-icon-arrow-down el-icon--right\"></i>\n                </span>\n                <el-dropdown-menu slot=\"dropdown\">\n                    <el-dropdown-item command=\"修改密码\">修改密码</el-dropdown-item>\n                    <el-dropdown-item command=\"添加用户\">添加用户</el-dropdown-item>\n                    <el-dropdown-item command=\"删除用户\">删除用户</el-dropdown-item>\n                </el-dropdown-menu>\n            </el-dropdown>\n                <div class=\"input-box\">\n                    <div class=\"input-item\">\n                        要编辑的用户名：<el-input v-model=\"inputUserName\" placeholder=\"请输入用户名\"></el-input>\n                    </div>\n                    <div class=\"input-item\">\n                        密码：<el-input :disabled=\"manageOpType === '删除用户'\" v-model=\"inputPassWord\" placeholder=\"请输入密码\"></el-input>\n                    </div>\n                    <div class=\"input-item\">\n                        账户类型：<el-radio :disabled=\"manageOpType !== '添加用户'\" v-model=\"inputUserType\" label=\"master\">master</el-radio>\n                                <el-radio :disabled=\"manageOpType !== '添加用户'\" v-model=\"inputUserType\" label=\"worker\">worker</el-radio>\n                    </div>\n                </div>\n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button  @click=\"manageTagShow = false\">取 消</el-button>\n                <el-button  type=\"primary\" @click=\"editUserInfo\" >确 定</el-button>\n            </span>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport request from '../utils/request';\n\nconst echarts = require('echarts');\n\nexport default {\n    name: 'operation',\n    data(){\n        return{\n            user: '',\n            userType: '',\n            showMobileMenu: false,\n            manageTagShow: false,\n            manageOpType: '修改密码',\n            inputUserName: '',\n            inputPassWord: '',\n            inputUserType: '',\n            IO1Status: false,\n            IO2Status: false,\n            motorIsOn: false,\n            isSlow: false,\n            isForward: false,\n            temperature: '',\n            humidity: '',\n            timeStamp: '',\n        }\n    },\n    mounted: function(){\n        const token = localStorage.getItem('token');\n        const that = this;\n        if(token){\n            axios.defaults.headers.common['token'] = token;\n            request('/users/verify', 'GET').then(function(response){\n                if(response.status === 200){\n                    that.user = response.data.userName;\n                    that.userType = response.data.type;\n                }   \n            })\n        };\n        request('/device/find', 'GET').then(function(response){\n            if(response.status === 200){\n                const deviceList = response.data;\n                for(let value of deviceList){\n                    switch(value.id){\n                        case 'device1':\n                        that.IO1Status = value.status;\n                        break;\n                        case 'device2':\n                        that.IO2Status = value.status;\n                        break;\n                        case 'device3':\n                        that.motorIsOn = value.status;\n                        that.isSlow = value.isSlow;\n                        that.isForward = value.isForward;\n                        break;\n                    }\n                }\n                that.drawLine();\n            }\n        })\n    },\n    methods: {\n        logout(){\n            localStorage.removeItem('token');\n            this.goToLogin();\n        },\n        goToLogin(){\n            this.$router.push({  \n                path:'/login',   \n            })\n        },\n        toggleMobileMenu(){\n            this.showMobileMenu = !this.showMobileMenu;\n        },\n        showManageTag(){\n            this.manageTagShow = !this.manageTagShow;\n        },\n        setOpType(type){\n            this.manageOpType = type;\n        },\n        editUserInfo(){\n            let path ; \n            let that = this;\n            let data = {\n                userName: this.inputUserName, \n                passWord: this.inputPassWord,\n                type: this.inputUserType,\n            }\n            switch(this.manageOpType){\n                case '修改密码':\n                path = '/users/update';\n                delete data.type;\n                break;\n                case '添加用户':\n                path = '/users/insert';\n                break;\n                case '删除用户':\n                path = '/users/delete';\n                delete data.passWord;\n                delete data.type;\n                break;\n            }\n            request(path, 'POST', data).then(function(response){\n                if(response.data.result === 'succeed'){\n                    that.manageTagShow = false;\n                    that.showMobileMenu = false;\n                    that.$message({\n                        message: '操作成功',\n                        type: 'success',\n                        customClass: 'messageBox',\n                    });\n                }\n            })\n        },\n        setDeviceStatus(deviceId){\n            let deviceStatus;\n            let setSpeed;\n            let setDirection;\n            switch(deviceId){\n                case 'device1':\n                deviceStatus = !this.IO1Status;\n                break;\n                case 'device2':\n                deviceStatus = !this.IO2Status;\n                break;\n                case 'device3':\n                deviceStatus = !this.motorIsOn;\n                break;\n                case 'speed':\n                setSpeed = {\n                    id: 'device3',\n                    isSlow: !this.isSlow\n                }\n                break;\n                case 'direction':\n                setDirection = {\n                    id: 'device3',\n                    isForward: !this.isForward\n                }\n            }\n            const path = '/device/setDevice';\n            const that = this;\n            const data = {\n                id: deviceId,\n                status: deviceStatus\n            };\n            request(path, 'POST', setSpeed||setDirection||data).then(function(response){\n                if(response.data === 'succeed'){\n                    switch(deviceId){\n                        case 'device1':\n                        that.IO1Status = !that.IO1Status;\n                        break;\n                        case 'device2':\n                        that.IO2Status = !that.IO2Status;\n                        break;\n                        case 'device3':\n                        that.motorIsOn = !that.motorIsOn;\n                        break;\n                        case 'speed':\n                        that.isSlow = !that.isSlow;\n                        break;\n                        case 'direction':\n                        that.isForward = !that.isForward;\n                    }\n                }else{\n                    that.$message({\n                        message: '操作失败',\n                        type: 'warning',\n                        customClass: 'messageBox',\n                        duration: 1500,\n                    });\n                }\n            })\n        },\n        drawLine(){\n            const temData = [];\n            const humData = [];\n            const chartOption = {\n                title: { text: '温湿度(%)' },\n                legend: {\n                    data: ['温度', '湿度']\n                },\n                animation: false,\n                tooltip: { trigger: 'axis' },\n                xAxis: {\n                    type: 'category',\n                    boundaryGap: false,\n                    data: [1, 2, 3, 4, 5, 6]\n                },\n                yAxis: {\n                    type: 'value'\n                },\n                series: [{\n                    name: '温度',\n                    type: 'line',\n                    data: temData\n                },\n                {\n                    name: '湿度',\n                    type: 'line',\n                    data: humData\n                }]\n            };\n            const chartContainner = this.$refs.chartContainner;\n            const that = this;\n            if(chartContainner){\n                let chart = echarts.init(chartContainner);\n                chart.setOption(chartOption);\n                setInterval(function(){\n                    request('/device/read', 'GET').then(function(response){\n                        if(response.data.temperature&&response.data.humidity){\n                            that.temperature = response.data.temperature;\n                            that.humidity = response.data.humidity;\n                            that.timeStamp = new Date();\n                            if(temData.length === 6) temData.shift();\n                            temData.push(response.data.temperature);\n                            if(humData.length === 6) humData.shift();\n                            humData.push(response.data.humidity);\n                            chart.setOption({\n                                 series: [{\n                                    seriesIndex: 0,\n                                    data: temData\n                                },\n                                {\n                                    seriesIndex: 1,\n                                    data: humData\n                                }]\n                            });\n                        }\n                    })\n                }, 2000)\n            }\n        }\n    }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n    .root{\n        background-color: #fdfdfd;\n        font: 25px \"Helvetica Neue\", \"Open Sans\", sans-serif;\n    }\n    .top-bar{\n        position: fixed;\n        top: 0;\n        left: 0;\n        background: #eee;\n        width: 100%;\n        height: 55px;\n        z-index: 100;\n        border-bottom: 1px solid #ddd;\n    }\n    h1{\n        display: block;\n        position: fixed;\n        top: 2px;\n        margin: 0;\n        padding: 10px 25px;\n        width: auto;\n        border-left: none;\n        z-index: 1;\n        font-weight: 100;\n        color: #444;\n        font-size: 28px;\n    }\n   .state{\n        color: #444;\n        padding: 12px 4px 0 5%;\n        max-width: 1180px;  \n        height: 100%;\n        position: relative;\n        display: flex;\n        justify-content: flex-end;\n        align-items: flex-start;\n        box-sizing: content-box;\n        ul{\n            padding: 0;\n            margin: 0;\n            right: 0px;\n            z-index: 1000;\n            li{\n                margin: 0 4px 0 4px;\n                list-style: none;\n                float: left;\n            }\n        }\n   }\n   .user-type{\n        font-size: 15px;\n        padding-top: 6px;\n        cursor: pointer;\n   }\n   .log-btn{\n        cursor: pointer;\n        padding-left: 40px;\n        font-size: 20px;\n   }\n   .mobile-menu-btn{\n       margin-right: 1%;\n       cursor: pointer;\n   }\n   .mobile-show{\n       display: none;\n   }\n   @media screen and (max-width: 750px){\n       .mobile-show{\n           display: block;\n       }\n       .pc-menu{\n           display: none;\n       }\n   }\n   .mobile-nav-bar{\n       position: absolute;\n       top: 57px;\n       width: 100%;\n       ul{\n           list-style: none;\n           li{\n               background-color: #eee;\n               padding: 6px 0 5px 0;\n               margin: 0;\n               font-size: 20px;\n               border-bottom: 1px solid #ccc;\n           }\n       }\n   }\n   .mobileMenuShow{\n       display: none;\n   }\n   .input-box{\n       width: 75%;\n       max-width: 450px;\n       margin: 20px auto;\n       margin-bottom: 0;\n       display: flex;\n       justify-content: center;\n       align-items: center;\n       flex-direction: column;\n   }\n   .input-item{\n       width: 100%;\n       margin: 10px 0;\n   }\n   .notice{\n       position: absolute;\n       top: 50%;\n       left: 50%;\n       transform: translateX(-50%) translateY(-50%);\n       font-size: 32px;\n   }\n   .operation-area{\n       font-size: 18px;\n       height: 370px;\n       margin: 30px 3%;\n       padding: 10px 0;\n       display: flex;\n       justify-content: center;\n       align-items: center;\n       flex-direction: column;\n   }\n   .device-btn{\n       margin: 10px 0;\n   }\n   .device-detail{\n       margin-right: 15px;\n   }\n   #chart{\n       width: 50%;\n       min-width: 330px;\n       margin: 0 auto;\n   }\n   #number-bar{\n        height: 60px;\n        margin-top: -60px;\n        font-size: 20px;\n        .time-stamp{\n            font-size: 14px;\n        }\n   }\n</style>\n\n\n"],"sourceRoot":"src/views"}]}